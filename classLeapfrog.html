<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ls1-MarDyn: Leapfrog Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ls1-MarDyn
   </div>
   <div id="projectbrief">ls1-MarDyn molecular dynamics code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classLeapfrog-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Leapfrog Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of the rotational leapfrog integration scheme.  
 <a href="classLeapfrog.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Leapfrog_8h_source.html">Leapfrog.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Leapfrog:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classLeapfrog.png" usemap="#Leapfrog_map" alt=""/>
  <map id="Leapfrog_map" name="Leapfrog_map">
<area href="classIntegrator.html" title="Update velocities and positions." alt="Integrator" shape="rect" coords="0,0,66,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:afa2d4144e7184845315f08bd30636f21"><td class="memItemLeft" align="right" valign="top"><a id="afa2d4144e7184845315f08bd30636f21" name="afa2d4144e7184845315f08bd30636f21"></a>enum &#160;</td><td class="memItemRight" valign="bottom">{ <b>STATE_UNKNOWN</b> = 0
, <b>STATE_NEW_TIMESTEP</b> = 1
, <b>STATE_PRE_FORCE_CALCULATION</b> = 2
, <b>STATE_POST_FORCE_CALCULATION</b> = 3
 }</td></tr>
<tr class="separator:afa2d4144e7184845315f08bd30636f21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a637ca9b13e31882486d2c78897876f60"><td class="memItemLeft" align="right" valign="top"><a id="a637ca9b13e31882486d2c78897876f60" name="a637ca9b13e31882486d2c78897876f60"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Leapfrog</b> (double timestepLength)</td></tr>
<tr class="memdesc:a637ca9b13e31882486d2c78897876f60"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor. <br /></td></tr>
<tr class="separator:a637ca9b13e31882486d2c78897876f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55f8a6a986eaba70bcc2fb371102715"><td class="memItemLeft" align="right" valign="top"><a id="aa55f8a6a986eaba70bcc2fb371102715" name="aa55f8a6a986eaba70bcc2fb371102715"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>~Leapfrog</b> ()</td></tr>
<tr class="memdesc:aa55f8a6a986eaba70bcc2fb371102715"><td class="mdescLeft">&#160;</td><td class="mdescRight">The destructor. <br /></td></tr>
<tr class="separator:aa55f8a6a986eaba70bcc2fb371102715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3726f31c1102f88467543b0c2c40bc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLeapfrog.html#ace3726f31c1102f88467543b0c2c40bc">readXML</a> (<a class="el" href="classXMLfileUnits.html">XMLfileUnits</a> &amp;xmlconfig)</td></tr>
<tr class="memdesc:ace3726f31c1102f88467543b0c2c40bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read in XML configuration for leapfrog integrator and all its included objects.  <a href="classLeapfrog.html#ace3726f31c1102f88467543b0c2c40bc">More...</a><br /></td></tr>
<tr class="separator:ace3726f31c1102f88467543b0c2c40bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ba0f558427674843d671eaaac387559"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLeapfrog.html#a7ba0f558427674843d671eaaac387559">init</a> ()</td></tr>
<tr class="separator:a7ba0f558427674843d671eaaac387559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5694d6acb5e42aed078fe06c929ffc22"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLeapfrog.html#a5694d6acb5e42aed078fe06c929ffc22">eventForcesCalculated</a> (<a class="el" href="classParticleContainer.html">ParticleContainer</a> *molCont, <a class="el" href="classDomain.html">Domain</a> *domain)</td></tr>
<tr class="memdesc:a5694d6acb5e42aed078fe06c929ffc22"><td class="mdescLeft">&#160;</td><td class="mdescRight">steps between the force calculation and the end of the time step  <a href="classLeapfrog.html#a5694d6acb5e42aed078fe06c929ffc22">More...</a><br /></td></tr>
<tr class="separator:a5694d6acb5e42aed078fe06c929ffc22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb824e8c26534201718781edfae8f269"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLeapfrog.html#aeb824e8c26534201718781edfae8f269">eventNewTimestep</a> (<a class="el" href="classParticleContainer.html">ParticleContainer</a> *molCont, <a class="el" href="classDomain.html">Domain</a> *domain)</td></tr>
<tr class="memdesc:aeb824e8c26534201718781edfae8f269"><td class="mdescLeft">&#160;</td><td class="mdescRight">performs all steps that can be done before new forces are needed  <a href="classLeapfrog.html#aeb824e8c26534201718781edfae8f269">More...</a><br /></td></tr>
<tr class="separator:aeb824e8c26534201718781edfae8f269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classIntegrator"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classIntegrator')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classIntegrator.html">Integrator</a></td></tr>
<tr class="memitem:a91fdfba81971dfa13ba22521d11b7c46 inherit pub_methods_classIntegrator"><td class="memItemLeft" align="right" valign="top"><a id="a91fdfba81971dfa13ba22521d11b7c46" name="a91fdfba81971dfa13ba22521d11b7c46"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Integrator</b> ()</td></tr>
<tr class="memdesc:a91fdfba81971dfa13ba22521d11b7c46 inherit pub_methods_classIntegrator"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor. <br /></td></tr>
<tr class="separator:a91fdfba81971dfa13ba22521d11b7c46 inherit pub_methods_classIntegrator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbbadd04691335a6b9123617ecdc426f inherit pub_methods_classIntegrator"><td class="memItemLeft" align="right" valign="top"><a id="acbbadd04691335a6b9123617ecdc426f" name="acbbadd04691335a6b9123617ecdc426f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Integrator</b> (double timestepLength)</td></tr>
<tr class="separator:acbbadd04691335a6b9123617ecdc426f inherit pub_methods_classIntegrator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada0ac381fb6d891c8074fd1ed2102229 inherit pub_methods_classIntegrator"><td class="memItemLeft" align="right" valign="top"><a id="ada0ac381fb6d891c8074fd1ed2102229" name="ada0ac381fb6d891c8074fd1ed2102229"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><b>~Integrator</b> ()</td></tr>
<tr class="memdesc:ada0ac381fb6d891c8074fd1ed2102229 inherit pub_methods_classIntegrator"><td class="mdescLeft">&#160;</td><td class="mdescRight">The destructor. <br /></td></tr>
<tr class="separator:ada0ac381fb6d891c8074fd1ed2102229 inherit pub_methods_classIntegrator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad555a52097a55b211e0cc70c25fe8573 inherit pub_methods_classIntegrator"><td class="memItemLeft" align="right" valign="top"><a id="ad555a52097a55b211e0cc70c25fe8573" name="ad555a52097a55b211e0cc70c25fe8573"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setTimestepLength</b> (double dt)</td></tr>
<tr class="memdesc:ad555a52097a55b211e0cc70c25fe8573 inherit pub_methods_classIntegrator"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the time between two time steps <br /></td></tr>
<tr class="separator:ad555a52097a55b211e0cc70c25fe8573 inherit pub_methods_classIntegrator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5989c7498071c594f79978ceac2959f inherit pub_methods_classIntegrator"><td class="memItemLeft" align="right" valign="top"><a id="ad5989c7498071c594f79978ceac2959f" name="ad5989c7498071c594f79978ceac2959f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>getTimestepLength</b> ()</td></tr>
<tr class="memdesc:ad5989c7498071c594f79978ceac2959f inherit pub_methods_classIntegrator"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the time between two time steps <br /></td></tr>
<tr class="separator:ad5989c7498071c594f79978ceac2959f inherit pub_methods_classIntegrator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classIntegrator"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classIntegrator')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classIntegrator.html">Integrator</a></td></tr>
<tr class="memitem:a9ca357e56870b0e0e6f470902f2d509c inherit pro_attribs_classIntegrator"><td class="memItemLeft" align="right" valign="top"><a id="a9ca357e56870b0e0e6f470902f2d509c" name="a9ca357e56870b0e0e6f470902f2d509c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>_timestepLength</b></td></tr>
<tr class="memdesc:a9ca357e56870b0e0e6f470902f2d509c inherit pro_attribs_classIntegrator"><td class="mdescLeft">&#160;</td><td class="mdescRight">time between time step n and time step (n+1) <br /></td></tr>
<tr class="separator:a9ca357e56870b0e0e6f470902f2d509c inherit pro_attribs_classIntegrator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Implementation of the rotational leapfrog integration scheme. </p>
<p >TODO: unnecessarily complicated and cluttered:</p><ul>
<li>remove states, transition*to*, they serve no purpose.</li>
<li>reimplement the thermostats, those maps are ugly.</li>
</ul>
<p >This <a class="el" href="classLeapfrog.html" title="Implementation of the rotational leapfrog integration scheme.">Leapfrog</a> integrator is implemented as a deterministic finite automaton (DFA):</p><ul>
<li>A state of the DFA corresponds to a coarse step in the integration loop. The following states are used:<ul>
<li>state 3: "starting state". The simulation has either just started, or the last steps of a time step have just been done. In state 3, the leapfrog integrator waits for the start of the next time time step</li>
<li>state 1: a new time step has just begun, the integrator is ready to start integrating (transition to state 2)</li>
<li>state 2: the first part is finished, now forces are needed to continue the integration</li>
</ul>
</li>
<li>consequently, the transitions do the following things:<ul>
<li>3 to 1: Nothing to do</li>
<li>1 to 2: calculate "preF"</li>
<li>2 to 3: calculate "postF"</li>
</ul>
</li>
<li>For the transition to another state, a condition has to be fulfilled There are two possibilities: The integrator has to wait for external information e.g. the new forces. In this case, the integrator is informed, that new forces have been calculated. The automaton can then do all necessary computations that have to be done do get from the current state to the next state</li>
</ul>
<p >For details about the algorithm see David Fincham's paper "Leapfrog rotational algorithms". <b>[Fincham-1993]</b> </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a5694d6acb5e42aed078fe06c929ffc22" name="a5694d6acb5e42aed078fe06c929ffc22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5694d6acb5e42aed078fe06c929ffc22">&#9670;&nbsp;</a></span>eventForcesCalculated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Leapfrog::eventForcesCalculated </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParticleContainer.html">ParticleContainer</a> *&#160;</td>
          <td class="paramname"><em>molCont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomain.html">Domain</a> *&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>steps between the force calculation and the end of the time step </p>
<p >checks whether the current state of the integrator allows that this method is called </p>

<p>Implements <a class="el" href="classIntegrator.html#a3b5312b17e0b2ec22d5e3b53fa213b2b">Integrator</a>.</p>

</div>
</div>
<a id="aeb824e8c26534201718781edfae8f269" name="aeb824e8c26534201718781edfae8f269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb824e8c26534201718781edfae8f269">&#9670;&nbsp;</a></span>eventNewTimestep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Leapfrog::eventNewTimestep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParticleContainer.html">ParticleContainer</a> *&#160;</td>
          <td class="paramname"><em>molCont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomain.html">Domain</a> *&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>performs all steps that can be done before new forces are needed </p>
<p >checks whether the current state of the integrator allows that this method is called </p>

<p>Implements <a class="el" href="classIntegrator.html#a4c0900bbe304fafe311d773bec4ae3bf">Integrator</a>.</p>

</div>
</div>
<a id="a7ba0f558427674843d671eaaac387559" name="a7ba0f558427674843d671eaaac387559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ba0f558427674843d671eaaac387559">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Leapfrog::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Initialize <a class="el" href="classIntegrator.html" title="Update velocities and positions.">Integrator</a> </p>

<p>Implements <a class="el" href="classIntegrator.html#aca1eefd71bdd9f7163e80ef50defab92">Integrator</a>.</p>

</div>
</div>
<a id="ace3726f31c1102f88467543b0c2c40bc" name="ace3726f31c1102f88467543b0c2c40bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace3726f31c1102f88467543b0c2c40bc">&#9670;&nbsp;</a></span>readXML()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Leapfrog::readXML </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classXMLfileUnits.html">XMLfileUnits</a> &amp;&#160;</td>
          <td class="paramname"><em>xmlconfig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read in XML configuration for leapfrog integrator and all its included objects. </p>
<p >The following xml object structure is handled by this method: </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">integrator</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;Leapfrog&quot;</span> &gt;</div>
<div class="line">  &lt;<span class="keywordtype">timestep</span>&gt;<span class="keyword">DOUBLE</span>&lt;/<span class="keywordtype">timestep</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">integrator</span>&gt;</div>
</div><!-- fragment --> 
<p>Implements <a class="el" href="classIntegrator.html">Integrator</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/integrators/<a class="el" href="Leapfrog_8h_source.html">Leapfrog.h</a></li>
<li>src/integrators/Leapfrog.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 20 2024 16:13:40 for ls1-MarDyn by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
