<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ls1-MarDyn: Unit Tests</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ls1-MarDyn
   </div>
   <div id="projectbrief">ls1-MarDyn molecular dynamics code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Unit Tests </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >ls1-MarDyn comes with a rich set of unit tests to check the functionality of its components. The underlying unit test framework used by ls1-MarDyn is CppUnit.</p>
<h1>Building and running Unit Tests </h1>
<p >To build the internal unit tests at least CppUnit 1.12.1 is required. The Unit Tests in ls1-MarDyn are enabled when build with the UNIT_TEST=1 option: </p><div class="fragment"><div class="line">make UNIT_TESTS=1 ...</div>
</div><!-- fragment --><p >If cppunit is installed at a non-standard location, its path can be specified with </p><div class="fragment"><div class="line">make UNIT_TESTS=1 CPPUNIT_DIR=&lt;PATH&gt; ...</div>
</div><!-- fragment --><p >To run all unit tests run ls1-MarDyn with </p><div class="fragment"><div class="line">mpirun -np 2 MarDyn -t -d ../test_input/</div>
</div><!-- fragment --><h1>Organisation of Unit Tests </h1>
<p >All tests are organized in directories called <b>tests</b>. A test-directory contains the tests for the code contained in its parent directory. It should be possible to derive the name of the source file under test from the classname of the testcase.</p>
<h1>Writing unit tests </h1>
<p >In the following the creation of Unit Tests in ls1-MarDyn shall be demonstrated with the testcase tests/CommonTest as a simple example.</p>
<dl class="section note"><dt>Note</dt><dd>Although cppunit is the testing framework used at the moment, DO NOT USE ANY CPPUNIT-FUNCTIONALITY DIRECTLY. Therefore and in order to keep the underlying testing framework exchangable, all framework-dependend things should be encapsulated.</dd></dl>
<h2>Writing the test header </h2>
<p >To create a new testcase, apply the following steps to your new header file:</p><ul>
<li>Create a new testclass, which inherits from utils::Test</li>
<li>Include the header <a class="el" href="Testing_8h_source.html">utils/Testing.h</a></li>
<li>Write the declarations of the test methods. It is recommended that you create one test method for each method which you are going to test. The name of test methods should start with "test"\. Thus, you end up with the following
  code:

  @code{.cpp} 
#include "<a class="el" href="Testing_8h_source.html">utils/Testing.h</a>"

class CommonTest : public utils::Test {

public:
    CommonTest();

    virtual ~CommonTest();

    void testGetTimeString();

    void testAlignedNumber();
};
\endcode

- Next declare the test suite, which will contain the single test methods. A good
  place is just at then beginning of the class. A test suite is declared with
  the macros TEST_SUITE(test_suite_name) and TEST_SUITE_END().
  Declare the unit tests in between those two macros with the macro
  TEST_METHOD(testGetTimeString).

  \note The argument of TEST_METHOD must match the name of a test function
        you declared in the last step!
  \note Each of the macros has to be terminated by a semicolon!

  The result is the final header:

@code 
#include &lt;utils/Testing.h&gt;

class CommonTest : public utils::Test {

    // declare testsuite commonTest
    TEST_SUITE(CommonTest);

    // add two methods which perform tests
    TEST_METHOD(testGetTimeString);
    TEST_METHOD(testAlignedNumber);

    // end suite declaration
    TEST_SUITE_END();

public:
    CommonTest();

    virtual ~CommonTest();

    void testGetTimeString();

    void testAlignedNumber();
};
\endcode

&lt;h2&gt;Writing the Unit Test Implementation
&lt;/h2&gt;

- Next implement the .cpp-file. Include the header of the test class as well as
  the header of the class being tested.

- &lt;b&gt;Directly below the includes, call the macro \"TEST_SUITE_REGISTRATION(test name)", with the name of the test class as argument! </li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;CommonTest.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Common.h&quot;</span></div>
<div class="line"> </div>
<div class="line">TEST_SUITE_REGISTRATION(CommonTest);</div>
</div><!-- fragment --><ul>
<li>Then implement the test functions. Use assertions to check results. Assertions are<ul>
<li>ASSERT_TRUE</li>
<li>ASSERT_TRUE_MSG</li>
<li>ASSERT_FAIL</li>
<li>ASSERT_EQUAL</li>
<li>ASSERT_EQUAL_MSG</li>
<li>ASSERT_DOUBLES_EQUAL</li>
<li>ASSERT_DOUBLES_EQUAL_MSG</li>
</ul>
</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="Testing_8h_source.html">utils/Testing.h</a></dd></dl>
<p>The implementation of a test method may look like </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> CommonTest::testGetTimeString() {</div>
<div class="line">    <a class="code hl_typedef" href="namespacexml__schema.html#aefbaf353f9a0043af46d23d9040ef268">std::string</a> <a class="code hl_typedef" href="namespacexml__schema.html#a75a88454d26d1fbbe712e22e9e994cee">time</a> = gettimestring();</div>
<div class="line">    ASSERT_EQUAL((<span class="keywordtype">size_t</span>)13, <a class="code hl_typedef" href="namespacexml__schema.html#a75a88454d26d1fbbe712e22e9e994cee">time</a>.size());</div>
<div class="line">    ASSERT_EQUAL(<a class="code hl_typedef" href="namespacexml__schema.html#a75a88454d26d1fbbe712e22e9e994cee">time</a>[6], <span class="charliteral">&#39;T&#39;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="anamespacexml__schema_html_a75a88454d26d1fbbe712e22e9e994cee"><div class="ttname"><a href="namespacexml__schema.html#a75a88454d26d1fbbe712e22e9e994cee">xml_schema::time</a></div><div class="ttdeci">::xsd::cxx::tree::time&lt; char, simple_type &gt; time</div><div class="ttdoc">C++ type corresponding to the time XML Schema built-in type.</div><div class="ttdef"><b>Definition:</b> xml-schema.h:436</div></div>
<div class="ttc" id="anamespacexml__schema_html_aefbaf353f9a0043af46d23d9040ef268"><div class="ttname"><a href="namespacexml__schema.html#aefbaf353f9a0043af46d23d9040ef268">xml_schema::string</a></div><div class="ttdeci">::xsd::cxx::tree::string&lt; char, simple_type &gt; string</div><div class="ttdoc">C++ type corresponding to the string XML Schema built-in type.</div><div class="ttdef"><b>Definition:</b> xml-schema.h:268</div></div>
</div><!-- fragment --><h2>General Thoughts about Tests </h2>
<ul>
<li>Think about testability, when you write code. Try to keep your methods small and simple. If your method is just too long or contains complex control flows, then your tests might get very complex as well. Thus, try to design your code for testability.</li>
<li>You might also try to test invalid input to your methods. E.g. if you specify that your method accepts only positive integer input values, try also negative ones and check if your code deals with that case the right way.</li>
<li>Of course tests will never cover 100 % of your code, and there will be bugs despite. For each bug you fixed, add a test. This will make sure that the bug will never again be introduced (e.g. by a developer who is not familiar with that part of the code).</li>
<li>Don't overdo tests - create a few tests per public method. Add only more tests, if certain parts of your code are likely to contain several bugs, or if code is rather complex.</li>
</ul>
<p >For more detailed information on testing see</p><ul>
<li>the "CppUnit Cookbook" (<b>Although you must not use anything cppunit-related directly!</b></li>
<li>JUnit - Pragmatic Programmer: Although written for JUnit, the general concept of tests is explained very well</li>
<li>XUnit Test Patterns </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 14 2022 11:43:58 for ls1-MarDyn by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
