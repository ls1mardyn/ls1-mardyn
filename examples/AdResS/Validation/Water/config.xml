<?xml version='1.0' encoding='UTF-8'?>
<mardyn version="20100525">
    <refunits type="SI">
        <length unit="nm">0.1</length>
        <mass unit="u">1.0</mass>
        <energy unit="eV">1.0</energy>
    </refunits>

    <!-- simulation options -->
    <simulation type="MD">
        <run>
            <currenttime>0</currenttime>
            <equilibration>
                <steps>0</steps>
            </equilibration>
            <production>
                <steps>10000</steps>
            </production>
        </run>
        <integrator type="Langevin">
            <!-- MD ODE integrator -->
            <timestep unit="reduced">0.0009118371969</timestep>
            <friction>0.2</friction>
            <ActiveRegions>
                <region>
                    <lower><x>0</x><y>0</y><z>0</z></lower>
                    <upper><x>80</x><y>40</y><z>40</z></upper>
                </region>
            </ActiveRegions>
        </integrator>
        <ensemble type="NVT">
            <!-- Target temperature is 1000K -->
            <!-- real gas closer to ideal gas at higher temperatures but lower pressures -->
            <temperature unit="reduced" >1000</temperature>
            <!-- low temp test: 200K -->
            <!--temperature unit="reduced" >0.961170213</temperature-->
            <domain type="box">
                <lx unit="reduced">80</lx>
                <ly unit="reduced">40</ly>
                <lz unit="reduced">40</lz>
            </domain>
            <!-- instead of lx/ly/lz we might accept density -->
            <components>
                <include query="/components/moleculetype">./components.xml</include>
            </components>

            <phasespacepoint>
                <generator name="MultiObjectGenerator">
                    <objectgenerator>
                        <filler type="ReplicaFiller">
                            <input type="BinaryReader">
                                <header>Water-Eq-FP-1.restart.header.xml</header>
                                <data>Water-Eq-FP-1.restart.dat</data>
                            </input>
                        </filler>

                        <object type="Cuboid">
                            <lower><x>0</x><y>0</y><z>0</z></lower>
                            <upper><x>80</x><y>40</y><z>40</z></upper>
                        </object>
                    </objectgenerator>
                </generator>
            </phasespacepoint>
        </ensemble>

        <algorithm>
            <parallelisation type="DomainDecomposition"/>
            <datastructure type="LinkedCells">
                <cellsInCutoffRadius>1</cellsInCutoffRadius>
                <traversalSelector>c08</traversalSelector>
            </datastructure>
            <cutoffs type="CenterOfMass">
                <radiusLJ unit="reduced">10.0</radiusLJ>
            </cutoffs>
            <electrostatic type="ReactionField">
                <epsilon>1</epsilon> <!-- TODO: dielectric constant water, for now use vacuum since P is very low -->
            </electrostatic>
            <thermostats>
                <thermostat type="TemperatureObserver">
                    <samples>100</samples>
                    <ActiveRegions>
                        <region>
                            <lower><x>0</x><y>0</y><z>0</z></lower>
                            <upper><x>80</x><y>40</y><z>40</z></upper>
                        </region>
                    </ActiveRegions>
                </thermostat>
            </thermostats>
        </algorithm>

        <output>
            <!--outputplugin name="VTKMoleculeWriter">
                <writefrequency>1</writefrequency>
                <writefrequencyOffset>0</writefrequencyOffset>
                <outputprefix>WaterTEST</outputprefix>
            </outputplugin-->
            <!--outputplugin name="CheckpointWriter">
                <type>binary</type>
                <writefrequency>20000</writefrequency>
                <outputprefix>Water-ADR</outputprefix>
            </outputplugin-->
            <!--outputplugin name="RDF">
                <writefrequency>500</writefrequency>
                <samplingfrequency>1</samplingfrequency>
                <outputprefix>water_test</outputprefix>
                <bins>5000</bins>
                <intervallength>0.001</intervallength>
            </outputplugin-->
            <!--outputplugin name="PressureProfiler">
                <bins>
                    <x>32</x><y>16</y><z>16</z>
                </bins>
                <outdims>x</outdims>
                <mode>Direct</mode>
                <samples>500</samples>
                <sampleFreq>1</sampleFreq>
                <writeFreq>500</writeFreq>
                <start>0</start>
                <filename>water_test_</filename>
            </outputplugin-->
        </output>

        <!--plugin name="SpatialProfile">
            <mode>cartesian</mode>
            <x>1000</x>
            <y>1</y>
            <z>1</z>
            <writefrequency>5000</writefrequency>
            <timesteps>
                <init>0</init>
                <recording>1</recording>
            </timesteps>
            <outputprefix>water_gmm_density</outputprefix>
            <profiledComponent>all</profiledComponent>
            <profiles>
                <density>true</density>
                <temperature>false</temperature>
                <velocity>false</velocity>
                <velocity3d>false</velocity3d>
                <virial>false</virial>
            </profiles>
        </plugin-->
        <plugin name="AdResS">
            <weightImpl>near</weightImpl>
            <enableFTH>
                <smoothingFactor>1</smoothingFactor>
                <logFTH>false</logFTH>
                <logDensity>true</logDensity>
                <rho>0.1</rho>
                <createFTH>
                    <sampleGap>10</sampleGap>
                    <threshold>0.05</threshold>
                    <convFactor>0</convFactor>
                    <sampleBinSize>5.0</sampleBinSize>
                    <measureFactor>3.536</measureFactor>
                </createFTH>
                <!--include query="/forceFunction">./F_TH_Final_0.xml</include-->
            </enableFTH>
            <fpregions>
                <region id="1">
                    <lowX>0.0</lowX><lowY>0.0</lowY><lowZ>0.0</lowZ>
                    <highX>80.0</highX><highY>40.0</highY><highZ>40.0</highZ>
                    <hybridDimX>0.0</hybridDimX><hybridDimY>0.0</hybridDimY><hybridDimZ>0.0</hybridDimZ>
                </region>
            </fpregions>
        </plugin>
        <!--plugin name="MaxCheck">
            <control>
                <start>0</start>
                <frequency>1</frequency>
                <stop>100000000</stop>
            </control>
            <range>
                <inclusive>true</inclusive>
                <xmin>31</xmin><xmax>49</xmax>
                <ymin>0</ymin><ymax>40</ymax>
                <zmin>0</zmin><zmax>40</zmax>
            </range>
            <targets>
                <target cid="2" method="1">
                    <Fmax>1e+3</Fmax>
                </target>
            </targets>
        </plugin-->
    </simulation>
</mardyn>
