<?xml version='1.0' encoding='UTF-8'?>
<!-- Run IBI on Equilibrated PS -->
<mardyn version="20100525" >
    <refunits type="SI" >
        <length unit="nm">0.1</length>
        <mass unit="u">1.0</mass>
        <energy unit="eV">1.0</energy>
    </refunits>

    <simulation type="MD" >
        <run>
            <currenttime>0</currenttime>
            <equilibration>
                <steps>0</steps>
            </equilibration>
            <production>
                <steps>100</steps>
            </production>
        </run>
        <integrator type="Leapfrog">
            <timestep unit="reduced">0.0009118371969</timestep>
        </integrator>
        <ensemble type="NVT">
            <!-- temp in Kelvin -->
            <temperature unit="reduced" >300</temperature>
            <domain type="box">
                <lx unit="reduced">100</lx>
                <ly unit="reduced">100</ly>
                <lz unit="reduced">100</lz>
            </domain>
            <components>
                <include query="/components/moleculetype">../comp_spc_o.xml</include>
            </components>

            <phasespacepoint>
                <generator name="MultiObjectGenerator">
                    <objectgenerator>
                        <filler type="ReplicaFiller">
                            <input type="BinaryReader">
                                <header>cubic-H2Oo-REF-EQ-250k-1.restart.header.xml</header>
                                <data>cubic-H2Oo-REF-EQ-250k-1.restart.dat</data>
                            </input>
                        </filler>

                        <object type="Cuboid">
                            <lower> <x>0</x> <y>0</y> <z>0</z> </lower>
                            <upper> <x>100</x> <y>100</y> <z>100</z> </upper>
                        </object>
                    </objectgenerator>
                </generator>
            </phasespacepoint>
        </ensemble>

        <algorithm>
            <parallelisation type="DomainDecomposition"/>
            <datastructure type="LinkedCells">
                <cellsInCutoffRadius>1</cellsInCutoffRadius>
                <traversalSelector>slice</traversalSelector>
            </datastructure>
            <cutoffs type="CenterOfMass" >
                <radiusLJ unit="reduced" >10</radiusLJ>
            </cutoffs>
            <electrostatic type="ReactionField" >
                <epsilon>1e+10</epsilon>
            </electrostatic>
            <thermostats>
                <thermostat type="VelocityScaling" componentId="global">
                    <temperature>300</temperature>
                </thermostat>
            </thermostats>
        </algorithm>

        <plugin name="AdResS">
            <weightImpl>near</weightImpl>
            <sampler type="FT">
                <sampleGap>500</sampleGap>
                <window>500000</window>
                <useReset>true</useReset>

                <dim>0</dim>
                <bins>4000</bins>
                <frequencies>8</frequencies>
            </sampler>

            <enableFTH>
                <logFTH>false</logFTH>
                <logDensity>false</logDensity>
                <rho>0.033</rho>
            </enableFTH>

            <fpregions>
                <region id="1">
                    <lowX>30.0</lowX><lowY>-10.0</lowY><lowZ>-10.0</lowZ>
                    <highX>70.0</highX><highY>110.0</highY><highZ>110.0</highZ>
                    <hybridDimX>20.0</hybridDimX><hybridDimY>0.0</hybridDimY><hybridDimZ>0.0</hybridDimZ>
                </region>
            </fpregions>

            <CG-Force>../../examples/AdResS/Validation/Water/liquid-case/force_o.txt</CG-Force>
            <CG-Pot>../../examples/AdResS/Validation/Water/liquid-case/pot_o.txt</CG-Pot>
        </plugin>
    </simulation>
</mardyn>
