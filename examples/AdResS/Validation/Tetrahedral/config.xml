<?xml version='1.0' encoding='UTF-8'?>
<mardyn version="20100525" >
    <refunits type="SI" >
        <!-- standard units - should be  used for internal reduction one day, but default for all values in simulation remain "reduced" -->
        <length unit="nm">0.0529177</length>	<!-- default: nm - also m,pm,fm or Angstroem may be used in the future? -->
        <mass unit="u">1.0</mass> <!-- also atomistic mass unit Dalton "u" in the future? -->
        <energy unit="eV">27.2126</energy> <!-- again: offer other units -->
    </refunits>

    <!-- simulation options -->
    <simulation type="MD" >
        <run>
            <currenttime>0</currenttime>
            <equilibration>
                <steps>0</steps>
            </equilibration>
            <production>
                <steps>10000</steps>
            </production>
        </run>
        <integrator type="Leapfrog">
            <!-- MD ODE integrator -->
            <timestep unit="reduced">0.002</timestep>
        </integrator>
        <ensemble type="NVT">
            <!--Ensemble is the main topic of the simulation -->
            <temperature unit="reduced" >1.5</temperature>	<!-- in future also units="K" -->
            <domain type="box">
                <lx unit="reduced">200.</lx>
                <ly unit="reduced">200.</ly>
                <lz unit="reduced">200.</lz>
            </domain>
            <!-- instead of lx/ly/lz we might accept density -->
            <components>
                <include query="/components/moleculetype">./components.xml</include>
            </components>

            <phasespacepoint>
                <generator name="MultiObjectGenerator">
                    <!--objectgenerator>
                        <filler type="GridFiller">
                            <lattice system="cubic" centering="face">
                                <vec id="a"> <x>1</x> <y>0</y> <z>0</z> </vec>
                                <vec id="b"> <x>0</x> <y>1</y> <z>0</z> </vec>
                                <vec id="c"> <x>0</x> <y>0</y> <z>1</z> </vec>
                            </lattice>
                            <basis>
                                <site>
                                    <componentid>0</componentid>
                                    <coordinate> <x>.5</x> <y>.5</y> <z>.5</z> </coordinate>
                                </site>
                            </basis>
                            <latticeOccupancy>1.</latticeOccupancy>
                            <density>0.005</density>
                        </filler>
                        <object type="Cuboid">
                            <lower> <x>0</x> <y>0</y> <z>0</z> </lower>
                            <upper> <x>200</x> <y>200</y> <z>200</z> </upper>
                        </object>
                        <velocityAssigner type="MaxwellVelocityDistribution"/>
                    </objectgenerator-->
                    <objectgenerator>
                        <filler type="ReplicaFiller">
                            <input type="BinaryReader">
                                <header>ValTet-1.restart.header.xml</header>
                                <data>ValTet-1.restart.dat</data>
                            </input>
                        </filler>

                        <object type="Cuboid">
                            <lower> <x>0</x> <y>0</y> <z>0</z> </lower>
                            <upper> <x>200</x> <y>200</y> <z>200</z> </upper>
                        </object>
                    </objectgenerator>
                </generator>
            </phasespacepoint>
        </ensemble>

        <algorithm>
            <parallelisation type="DomainDecomposition"/>
            <datastructure type="LinkedCells">
                <cellsInCutoffRadius>1</cellsInCutoffRadius>
                <traversalSelector>c08</traversalSelector>
            </datastructure>
            <cutoffs type="CenterOfMass" >
                <radiusLJ unit="reduced" >10.0</radiusLJ>
            </cutoffs>
            <electrostatic type="ReactionField" >
                <epsilon>0</epsilon>
            </electrostatic>
            <thermostats>
                <thermostat type="TemperatureControl">
                    <control>
                        <start>0</start>
                        <frequency>1</frequency>
                        <stop>1000000000</stop>
                    </control>
                    <regions>
                        <region>
                            <method>VelocityScaling</method>
                            <coords>
                                <lcx>0.0</lcx>
                                <lcy>0.0</lcy>
                                <lcz>0.0</lcz>
                                <ucx>70</ucx>
                                <ucy>200</ucy>
                                <ucz>200</ucz>
                            </coords>
                            <target>
                                <temperature>1.5</temperature>
                                <component>3</component>
                            </target>
                            <settings>
                                <numslabs>4</numslabs>
                                <exponent>0.0</exponent>
                                <directions>xyz</directions>
                            </settings>
                            <writefreq>10000000</writefreq>
                            <fileprefix>temp0</fileprefix>
                        </region>
                        <region>
                            <method>VelocityScaling</method>
                            <coords>
                                <lcx>70.0</lcx>
                                <lcy>0.0</lcy>
                                <lcz>0.0</lcz>
                                <ucx>80</ucx>
                                <ucy>200</ucy>
                                <ucz>200</ucz>
                            </coords>
                            <target>
                                <temperature>1.5</temperature>
                                <component>2</component>
                            </target>
                            <settings>
                                <numslabs>4</numslabs>
                                <exponent>0.0</exponent>
                                <directions>xyz</directions>
                            </settings>
                            <writefreq>10000000</writefreq>
                            <fileprefix>temp1</fileprefix>
                        </region>
                        <region>
                            <method>VelocityScaling</method>
                            <coords>
                                <lcx>120.0</lcx>
                                <lcy>0.0</lcy>
                                <lcz>0.0</lcz>
                                <ucx>130</ucx>
                                <ucy>200</ucy>
                                <ucz>200</ucz>
                            </coords>
                            <target>
                                <temperature>1.5</temperature>
                                <component>2</component>
                            </target>
                            <settings>
                                <numslabs>4</numslabs>
                                <exponent>0.0</exponent>
                                <directions>xyz</directions>
                            </settings>
                            <writefreq>10000000</writefreq>
                            <fileprefix>temp2</fileprefix>
                        </region>
                        <region>
                            <method>VelocityScaling</method>
                            <coords>
                                <lcx>130.0</lcx>
                                <lcy>0.0</lcy>
                                <lcz>0.0</lcz>
                                <ucx>200</ucx>
                                <ucy>200</ucy>
                                <ucz>200</ucz>
                            </coords>
                            <target>
                                <temperature>1.5</temperature>
                                <component>3</component>
                            </target>
                            <settings>
                                <numslabs>4</numslabs>
                                <exponent>0.0</exponent>
                                <directions>xyz</directions>
                            </settings>
                            <writefreq>10000000</writefreq>
                            <fileprefix>temp3</fileprefix>
                        </region>
                    </regions>
                </thermostat>
            </thermostats>
        </algorithm>

        <output>
            <!--outputplugin name="VTKMoleculeWriter">
                <writefrequency>1000</writefrequency>
                <writefrequencyOffset>0</writefrequencyOffset>
                <outputprefix>Validation</outputprefix>
            </outputplugin-->
            <outputplugin name="CheckpointWriter">
                <type>binary</type>
                <writefrequency>10000</writefrequency>
                <outputprefix>ValTetRun</outputprefix>
            </outputplugin>
            <outputplugin name="RDF">
                <!-- functionality affected by <equilibration> <steps> X </steps> </equilibration> -->
                <writefrequency>1000</writefrequency>
                <samplingfrequency>100</samplingfrequency>
                <outputprefix>default</outputprefix>
                <bins>1000</bins>
                <intervallength>0.001</intervallength>
            </outputplugin>
        </output>

        <plugin name="AdResS">
            <weightImpl>near</weightImpl>
            <enableFTH>
                <fmax>250</fmax>
                <logFTH>true</logFTH>
                <logDensity>true</logDensity>
                <rho>0.005</rho>
                <smoothingFactor>10</smoothingFactor>
                <createFTH>
                    <sampleGap>200</sampleGap>
                    <threshold>5e-7</threshold>
                    <convFactor>5e-1</convFactor>
                    <sampleBinSize>1.0</sampleBinSize>
                </createFTH>
                <!--include query="/forceFunction">./F_TH.xml</include-->
            </enableFTH>
            <fpregions>
                <region id="1">
                    <lowX>80.0</lowX><lowY>0.0</lowY><lowZ>0.0</lowZ>
                    <highX>120.0</highX><highY>200.0</highY><highZ>200.0</highZ>
                    <hybridDimX>10.0</hybridDimX><hybridDimY>0.0</hybridDimY><hybridDimZ>0.0</hybridDimZ>
                </region>
            </fpregions>
        </plugin>

    </simulation>
</mardyn>
