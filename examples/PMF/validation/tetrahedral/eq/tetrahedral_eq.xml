<?xml version="1.0" encoding="UTF-8"?>
<mardyn version="20100525">
  <refunits type="SI">
    <length unit="nm">0.0529177</length>
    <mass unit="u">1000</mass>
    <energy unit="eV">27.2126</energy>
  </refunits>
  <simulation type="MD">
    <integrator type="Leapfrog">
      <timestep unit="reduced">0.001</timestep>
    </integrator>
    
    <run>
      <currenttime>0</currenttime>
      <equilibration> <steps>0</steps> </equilibration>
      <production>
        <steps>100000</steps>
      </production>
    </run>
    
    <ensemble type="NVT">
      <temperature unit="reduced">1.0</temperature>
      <domain type="box">
        <lx>36.845</lx>
        <ly>36.845</ly>
        <lz>36.845</lz>
      </domain>
      <components>
        <include query="/components/moleculetype">../../components/lj_tetrahedral.xml</include>
      </components>
      <!--phasespacepoint>
        <file type="binary">
          <header>restart_data_case_c/generic_lj_step-0390.restart.restart.header.xml</header>
          <data>restart_data_case_c/generic_lj_step-0390.restart.dat</data>
        </file>
      </phasespacepoint-->
      <phasespacepoint>
        <generator name="MultiObjectGenerator">
            <objectgenerator>
                <filler type="GridFiller">
                    <lattice system="cubic" centering="face">
                        <vec id="a"> <x>1</x> <y>0</y> <z>0</z> </vec>
                        <vec id="b"> <x>0</x> <y>1</y> <z>0</z> </vec>
                        <vec id="c"> <x>0</x> <y>0</y> <z>1</z> </vec>
                    </lattice>
                    <basis>
                        <site>
                            <componentid>0</componentid>
                            <coordinate> <x>0.5</x> <y>0.5</y> <z>0.5</z> </coordinate>
                        </site>
                    </basis>
                    <latticeOccupancy>1.</latticeOccupancy>
                    <density>0.1</density>
                </filler>
                <object type="Cuboid">
                    <lower> <x>0</x> <y>0</y> <z>0</z> </lower>
                    <upper> <x>36.845</x> <y>36.845</y> <z>36.845</z> </upper>
                </object>
                <velocityAssigner type="MaxwellVelocityDistribution"/>
            </objectgenerator>
        </generator>
    </phasespacepoint>
    </ensemble>
    
    <algorithm>
      <parallelisation type="DomainDecomposition">
        <timerForLoad>SIMULATION_FORCE_CALCULATION</timerForLoad>
        <overlappingCollectives>False</overlappingCollectives>
      </parallelisation>
      <datastructure type="LinkedCells">
        <cellsInCutoffRadius>1</cellsInCutoffRadius>
      </datastructure>
      <cutoffs type="CenterOfMass">
        <radiusLJ unit="reduced">4.5</radiusLJ>
      </cutoffs>
      <electrostatic type="ReactionField">
        <epsilon>1.0e+10</epsilon>
      </electrostatic>
      <thermostats>
       <!-- velocity scaling thermostat, if no component is specified the global thermostat is assumed -->
      <thermostat type="VelocityScaling">
        <!-- target temperature, if not specified the ensemble temperature will be used -->
      </thermostat> 
      </thermostats>
      
    </algorithm>
    
    <output>
 
    <outputplugin name="VTKMoleculeWriter">
      <outputprefix>vtkOutput</outputprefix>
      <writefrequency>1000</writefrequency>
    </outputplugin>

    <outputplugin name="CheckpointWriter">
      <type>binary</type>
      <writefrequency>100</writefrequency>
      <outputprefix>tetrahedral_step</outputprefix>
    </outputplugin>

    </output>

    <plugin name="PMF">
      <fpregions>
        <region id = "1">
          <lowX>0.0</lowX><lowy>0.0</lowy><lowZ>0.0</lowZ>
          <highX>36.845</highX><highY>36.845</highY><highZ>36.845</highZ>
          <hybridDimX>0</hybridDimX><hybridDimY>0.0</hybridDimY>
          <hybridDimZ>0.0</hybridDimZ>
        </region>
      </fpregions>
      <multiplier>1.0</multiplier>
      <internalBins>200</internalBins>
      <densityBins>25</densityBins>
      <measureFreq>1</measureFreq>
      <updateStride>1000</updateStride>
      <outputFreq>5</outputFreq>
      <output>true</output>
      <mode>Equilibration</mode>
  </plugin>
	
  </simulation>
</mardyn>
