<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ls1-MarDyn: MamicoCoupling Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ls1-MarDyn
   </div>
   <div id="projectbrief">ls1-MarDyn molecular dynamics code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classMamicoCoupling-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MamicoCoupling Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Allows execution of MaMiCo code to enable coupling with MaMiCo.  
 <a href="classMamicoCoupling.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="MamicoCoupling_8h_source.html">MamicoCoupling.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for MamicoCoupling:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMamicoCoupling.png" usemap="#MamicoCoupling_map" alt=""/>
  <map id="MamicoCoupling_map" name="MamicoCoupling_map">
<area href="classPluginBase.html" title="The PluginBase class provides the interface for any kind of output/plugin classes - called &quot;(output) ..." alt="PluginBase" shape="rect" coords="0,0,106,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a657343c77e760906a5161e3f8f091ef1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#a657343c77e760906a5161e3f8f091ef1">init</a> (<a class="el" href="classParticleContainer.html">ParticleContainer</a> *particleContainer, <a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *domainDecomp, <a class="el" href="classDomain.html">Domain</a> *domain) override</td></tr>
<tr class="memdesc:a657343c77e760906a5161e3f8f091ef1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints to log that mamico coupling is initialized.  <a href="classMamicoCoupling.html#a657343c77e760906a5161e3f8f091ef1">More...</a><br /></td></tr>
<tr class="separator:a657343c77e760906a5161e3f8f091ef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a984b5aaf47fb71798b9653f15daaac5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#a984b5aaf47fb71798b9653f15daaac5b">readXML</a> (<a class="el" href="classXMLfileUnits.html">XMLfileUnits</a> &amp;xmlconfig) override</td></tr>
<tr class="memdesc:a984b5aaf47fb71798b9653f15daaac5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method readXML will be called once for each plugin section in the input file.  <a href="classMamicoCoupling.html#a984b5aaf47fb71798b9653f15daaac5b">More...</a><br /></td></tr>
<tr class="separator:a984b5aaf47fb71798b9653f15daaac5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad50044815ff354fc7f25edabb9f1fb4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#ad50044815ff354fc7f25edabb9f1fb4a">beforeEventNewTimestep</a> (<a class="el" href="classParticleContainer.html">ParticleContainer</a> *particleContainer, <a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *domainDecomp, unsigned long simstep) override</td></tr>
<tr class="memdesc:ad50044815ff354fc7f25edabb9f1fb4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method will be called first thing in a new timestep.  <a href="classMamicoCoupling.html#ad50044815ff354fc7f25edabb9f1fb4a">More...</a><br /></td></tr>
<tr class="separator:ad50044815ff354fc7f25edabb9f1fb4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5e3af54052cc87b2b351a6ac1f6b208"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#ab5e3af54052cc87b2b351a6ac1f6b208">beforeForces</a> (<a class="el" href="classParticleContainer.html">ParticleContainer</a> *particleContainer, <a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *domainDecomp, unsigned long simstep) override</td></tr>
<tr class="memdesc:ab5e3af54052cc87b2b351a6ac1f6b208"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes coupling steps such as particle insertion, to make sure they are accounted for before forces are calculated.  <a href="classMamicoCoupling.html#ab5e3af54052cc87b2b351a6ac1f6b208">More...</a><br /></td></tr>
<tr class="separator:ab5e3af54052cc87b2b351a6ac1f6b208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b32621ba28088df25c25be9d89c127"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#aa4b32621ba28088df25c25be9d89c127">afterForces</a> (<a class="el" href="classParticleContainer.html">ParticleContainer</a> *particleContainer, <a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *domainDecomp, unsigned long simstep) override</td></tr>
<tr class="memdesc:aa4b32621ba28088df25c25be9d89c127"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs adjustments after force calculation.  <a href="classMamicoCoupling.html#aa4b32621ba28088df25c25be9d89c127">More...</a><br /></td></tr>
<tr class="separator:aa4b32621ba28088df25c25be9d89c127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c38e0b7be93c0012b84f534d4dbfd79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#a5c38e0b7be93c0012b84f534d4dbfd79">endStep</a> (<a class="el" href="classParticleContainer.html">ParticleContainer</a> *particleContainer, <a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *domainDecomp, <a class="el" href="classDomain.html">Domain</a> *domain, unsigned long simstep) override</td></tr>
<tr class="memdesc:a5c38e0b7be93c0012b84f534d4dbfd79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method endStep will be called at the end of each time step.  <a href="classMamicoCoupling.html#a5c38e0b7be93c0012b84f534d4dbfd79">More...</a><br /></td></tr>
<tr class="separator:a5c38e0b7be93c0012b84f534d4dbfd79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88890ee7691367dd55cfd29f19189663"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#a88890ee7691367dd55cfd29f19189663">finish</a> (<a class="el" href="classParticleContainer.html">ParticleContainer</a> *particleContainer, <a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *domainDecomp, <a class="el" href="classDomain.html">Domain</a> *domain) override</td></tr>
<tr class="memdesc:a88890ee7691367dd55cfd29f19189663"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method finish will be called at the end of the simulation.  <a href="classMamicoCoupling.html#a88890ee7691367dd55cfd29f19189663">More...</a><br /></td></tr>
<tr class="separator:a88890ee7691367dd55cfd29f19189663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660a7853eb7929656bc69f7dac02d5b1"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#a660a7853eb7929656bc69f7dac02d5b1">getPluginName</a> () override</td></tr>
<tr class="memdesc:a660a7853eb7929656bc69f7dac02d5b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the name of the plugin  <a href="classMamicoCoupling.html#a660a7853eb7929656bc69f7dac02d5b1">More...</a><br /></td></tr>
<tr class="separator:a660a7853eb7929656bc69f7dac02d5b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3dce23be5040f79f303be090575d74c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#af3dce23be5040f79f303be090575d74c">switchOnCoupling</a> ()</td></tr>
<tr class="memdesc:af3dce23be5040f79f303be090575d74c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables coupling logic, allowing coupling steps to run while simulation is running.  <a href="classMamicoCoupling.html#af3dce23be5040f79f303be090575d74c">More...</a><br /></td></tr>
<tr class="separator:af3dce23be5040f79f303be090575d74c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a349e451d9bcc6eac13a2d1528a7066ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#a349e451d9bcc6eac13a2d1528a7066ec">switchOffCoupling</a> ()</td></tr>
<tr class="memdesc:a349e451d9bcc6eac13a2d1528a7066ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disables coupling logic, not allowing coupling steps to run. Typically done when equilibrating the simulation initially.  <a href="classMamicoCoupling.html#a349e451d9bcc6eac13a2d1528a7066ec">More...</a><br /></td></tr>
<tr class="separator:a349e451d9bcc6eac13a2d1528a7066ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cef5dc9a6a13a36b4048ba382079e27"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMamicoCoupling.html#a2cef5dc9a6a13a36b4048ba382079e27">getCouplingState</a> ()</td></tr>
<tr class="memdesc:a2cef5dc9a6a13a36b4048ba382079e27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter method for the coupling state.  <a href="classMamicoCoupling.html#a2cef5dc9a6a13a36b4048ba382079e27">More...</a><br /></td></tr>
<tr class="separator:a2cef5dc9a6a13a36b4048ba382079e27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPluginBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPluginBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPluginBase.html">PluginBase</a></td></tr>
<tr class="memitem:ab59f1c42801522322ebf1dd6a0d5d0b8 inherit pub_methods_classPluginBase"><td class="memItemLeft" align="right" valign="top"><a id="ab59f1c42801522322ebf1dd6a0d5d0b8" name="ab59f1c42801522322ebf1dd6a0d5d0b8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PluginBase</b> ()</td></tr>
<tr class="memdesc:ab59f1c42801522322ebf1dd6a0d5d0b8 inherit pub_methods_classPluginBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subclasses should use their constructur to pass parameters (e.g. filenames) <br /></td></tr>
<tr class="separator:ab59f1c42801522322ebf1dd6a0d5d0b8 inherit pub_methods_classPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa1f058f322b9822eed3cdecd6aae74 inherit pub_methods_classPluginBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPluginBase.html#a5aa1f058f322b9822eed3cdecd6aae74">siteWiseForces</a> (<a class="el" href="classParticleContainer.html">ParticleContainer</a> *, <a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *, unsigned long)</td></tr>
<tr class="memdesc:a5aa1f058f322b9822eed3cdecd6aae74 inherit pub_methods_classPluginBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method siteWiseForces will be called before forcefields have been applied alterations to sitewise forces and fullMolecule forces can be made here.  <a href="classPluginBase.html#a5aa1f058f322b9822eed3cdecd6aae74">More...</a><br /></td></tr>
<tr class="separator:a5aa1f058f322b9822eed3cdecd6aae74 inherit pub_methods_classPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeba6d69e68cc3b73036d105486c31b67 inherit pub_methods_classPluginBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPluginBase.html#aeba6d69e68cc3b73036d105486c31b67">registerCallbacks</a> (std::map&lt; std::string, <a class="el" href="classFunctionWrapper.html">FunctionWrapper</a> &gt; &amp;callbackMap)</td></tr>
<tr class="separator:aeba6d69e68cc3b73036d105486c31b67 inherit pub_methods_classPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa32904e9f109add9a2699ff2c6347aa inherit pub_methods_classPluginBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPluginBase.html#aaa32904e9f109add9a2699ff2c6347aa">accessAllCallbacks</a> (const std::map&lt; std::string, <a class="el" href="classFunctionWrapper.html">FunctionWrapper</a> &gt; &amp;callbackMap)</td></tr>
<tr class="separator:aaa32904e9f109add9a2699ff2c6347aa inherit pub_methods_classPluginBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a5d90d734edec37024f8ffeef0e897268"><td class="memItemLeft" align="right" valign="top"><a id="a5d90d734edec37024f8ffeef0e897268" name="a5d90d734edec37024f8ffeef0e897268"></a>
static <a class="el" href="classPluginBase.html">PluginBase</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>createInstance</b> ()</td></tr>
<tr class="separator:a5d90d734edec37024f8ffeef0e897268"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Allows execution of MaMiCo code to enable coupling with MaMiCo. </p>
<p >When MaMiCo is coupled with any simulation software, it needs to control the simulation from both the outside and inside. From the outside, MaMiCo needs to be able to start and stop the simulation, and keep unique simulations distinct. From the inside, MaMiCo code needs to be executed at specific points within the same simulation step. This plugin enables the "inside" behaviour.</p>
<p >MaMiCo coupling requires the MAMICO_COUPLING flag to be set, and the MAMICO_SRD_DIR flag to point to MaMiCo source files. With these enabled, ls1 compiles as a library. To make sure the program compiles and works with tests, the relevant MaMiCo portions for the code are put in #ifdef regions. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aa4b32621ba28088df25c25be9d89c127" name="aa4b32621ba28088df25c25be9d89c127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b32621ba28088df25c25be9d89c127">&#9670;&nbsp;</a></span>afterForces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MamicoCoupling::afterForces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParticleContainer.html">ParticleContainer</a> *&#160;</td>
          <td class="paramname"><em>particleContainer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *&#160;</td>
          <td class="paramname"><em>domainDecomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>simstep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs adjustments after force calculation. </p>
<p >Following steps are taken, if coupling is switched on:</p><ul>
<li>Distribute incoming momentum among affected cells</li>
<li>Apply boundary force to molecules near microscopic domain boundary </li>
</ul>

<p>Reimplemented from <a class="el" href="classPluginBase.html#ad358acf7c5b5b895df21562c70a34a2f">PluginBase</a>.</p>

</div>
</div>
<a id="ad50044815ff354fc7f25edabb9f1fb4a" name="ad50044815ff354fc7f25edabb9f1fb4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad50044815ff354fc7f25edabb9f1fb4a">&#9670;&nbsp;</a></span>beforeEventNewTimestep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MamicoCoupling::beforeEventNewTimestep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParticleContainer.html">ParticleContainer</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method will be called first thing in a new timestep. </p>

<p>Reimplemented from <a class="el" href="classPluginBase.html#a69bdae0b01153fabd0785c0f7d1f2c2f">PluginBase</a>.</p>

</div>
</div>
<a id="ab5e3af54052cc87b2b351a6ac1f6b208" name="ab5e3af54052cc87b2b351a6ac1f6b208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5e3af54052cc87b2b351a6ac1f6b208">&#9670;&nbsp;</a></span>beforeForces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MamicoCoupling::beforeForces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParticleContainer.html">ParticleContainer</a> *&#160;</td>
          <td class="paramname"><em>particleContainer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *&#160;</td>
          <td class="paramname"><em>domainDecomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>simstep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Takes coupling steps such as particle insertion, to make sure they are accounted for before forces are calculated. </p>
<p >Following steps are taken, if coupling is switched on:</p><ul>
<li>Iterate over cells to average values like momentum and mass, to pass to macroscopic solvers</li>
<li>Distribute incoming mass from macroscopic solver by inserting perticles (if enabled)</li>
<li>Run the MaMiCo thermostat cell by cell</li>
</ul>
<p >The distributeMass method calls the updateParticleContainerAndDecomposition() function at the end, so we end up with a container with halo particles present. Hence a manual halo clearance is done to restore the state of the container. </p>

<p>Reimplemented from <a class="el" href="classPluginBase.html#aec6f3065650556bd93e35570e7969057">PluginBase</a>.</p>

</div>
</div>
<a id="a5c38e0b7be93c0012b84f534d4dbfd79" name="a5c38e0b7be93c0012b84f534d4dbfd79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c38e0b7be93c0012b84f534d4dbfd79">&#9670;&nbsp;</a></span>endStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MamicoCoupling::endStep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParticleContainer.html">ParticleContainer</a> *&#160;</td>
          <td class="paramname"><em>particleContainer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *&#160;</td>
          <td class="paramname"><em>domainDecomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomain.html">Domain</a> *&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>simstep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method endStep will be called at the end of each time step. </p>
<p >This method will be called every time step passing the simstep as an additional parameter. It can be used e.g. to write per time step data to a file or perform additional computations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particleContainer</td><td>particle container storing the (local) molecules </td></tr>
    <tr><td class="paramname">domainDecomp</td><td>domain decomposition in use </td></tr>
    <tr><td class="paramname">domain</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classPluginBase.html#aad4e7f87aaafbb4128984db87ea7a01f">PluginBase</a>.</p>

</div>
</div>
<a id="a88890ee7691367dd55cfd29f19189663" name="a88890ee7691367dd55cfd29f19189663"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88890ee7691367dd55cfd29f19189663">&#9670;&nbsp;</a></span>finish()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MamicoCoupling::finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParticleContainer.html">ParticleContainer</a> *&#160;</td>
          <td class="paramname"><em>particleContainer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *&#160;</td>
          <td class="paramname"><em>domainDecomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomain.html">Domain</a> *&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method finish will be called at the end of the simulation. </p>
<p >This method will be called once at the end of the simulation. It can be used e.g. to closing output files or writing final statistics. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particleContainer</td><td>particle container storing the (local) molecules </td></tr>
    <tr><td class="paramname">domainDecomp</td><td>domain decomposition in use </td></tr>
    <tr><td class="paramname">domain</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classPluginBase.html#a5326ea6d3c54cc5d8511e16db32a2a8f">PluginBase</a>.</p>

</div>
</div>
<a id="a2cef5dc9a6a13a36b4048ba382079e27" name="a2cef5dc9a6a13a36b4048ba382079e27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cef5dc9a6a13a36b4048ba382079e27">&#9670;&nbsp;</a></span>getCouplingState()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MamicoCoupling::getCouplingState </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Getter method for the coupling state. </p>
<p >Not used currently, but may be used in future </p>

</div>
</div>
<a id="a660a7853eb7929656bc69f7dac02d5b1" name="a660a7853eb7929656bc69f7dac02d5b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a660a7853eb7929656bc69f7dac02d5b1">&#9670;&nbsp;</a></span>getPluginName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MamicoCoupling::getPluginName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return the name of the plugin </p>

<p>Implements <a class="el" href="classPluginBase.html#a179125e53b68d799538e7a4b8791847c">PluginBase</a>.</p>

</div>
</div>
<a id="a657343c77e760906a5161e3f8f091ef1" name="a657343c77e760906a5161e3f8f091ef1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a657343c77e760906a5161e3f8f091ef1">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MamicoCoupling::init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParticleContainer.html">ParticleContainer</a> *&#160;</td>
          <td class="paramname"><em>particleContainer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomainDecompBase.html">DomainDecompBase</a> *&#160;</td>
          <td class="paramname"><em>domainDecomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDomain.html">Domain</a> *&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prints to log that mamico coupling is initialized. </p>

<p>Implements <a class="el" href="classPluginBase.html#adee107999a63b3be6d2f48686bc3ccbb">PluginBase</a>.</p>

</div>
</div>
<a id="a984b5aaf47fb71798b9653f15daaac5b" name="a984b5aaf47fb71798b9653f15daaac5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a984b5aaf47fb71798b9653f15daaac5b">&#9670;&nbsp;</a></span>readXML()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MamicoCoupling::readXML </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classXMLfileUnits.html">XMLfileUnits</a> &amp;&#160;</td>
          <td class="paramname"><em>xmlconfig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method readXML will be called once for each plugin section in the input file. </p>
<p >This method can be used to read in parameters from the corresponding plugin section in the xml config file. The method will be called once after an instance of the plugin is created.</p>
<dl class="section note"><dt>Note</dt><dd>The same plugins may be specified multiple times in the xml config file. It is the responsibility of the plugin to handle this case in a propper way.</dd></dl>
<p>The following xml object structure will be provided to the plugin: </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">plugin</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;plugin name&quot;</span>&gt;</div>
<div class="line">  <span class="comment">&lt;!-- options for the specific plugin --&gt;</span></div>
<div class="line">&lt;/<span class="keywordtype">plugin</span>&gt;</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xmlconfig</td><td>section of the xml file </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classPluginBase.html#a8a934b89aa2a46081c62351d4d95c71b">PluginBase</a>.</p>

</div>
</div>
<a id="a349e451d9bcc6eac13a2d1528a7066ec" name="a349e451d9bcc6eac13a2d1528a7066ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a349e451d9bcc6eac13a2d1528a7066ec">&#9670;&nbsp;</a></span>switchOffCoupling()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MamicoCoupling::switchOffCoupling </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disables coupling logic, not allowing coupling steps to run. Typically done when equilibrating the simulation initially. </p>
<p >Set from within MaMiCo, check <a href="https://github.com/HSU-HPC/MaMiCo/blob/master/coupling/interface/MDSimulationFactory.h">https://github.com/HSU-HPC/MaMiCo/blob/master/coupling/interface/MDSimulationFactory.h</a>, class LS1MDSimulation </p>

</div>
</div>
<a id="af3dce23be5040f79f303be090575d74c" name="af3dce23be5040f79f303be090575d74c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3dce23be5040f79f303be090575d74c">&#9670;&nbsp;</a></span>switchOnCoupling()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MamicoCoupling::switchOnCoupling </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enables coupling logic, allowing coupling steps to run while simulation is running. </p>
<p >Set from within MaMiCo, check <a href="https://github.com/HSU-HPC/MaMiCo/blob/master/coupling/interface/MDSimulationFactory.h">https://github.com/HSU-HPC/MaMiCo/blob/master/coupling/interface/MDSimulationFactory.h</a>, class LS1MDSimulation </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/plugins/<a class="el" href="MamicoCoupling_8h_source.html">MamicoCoupling.h</a></li>
<li>src/plugins/MamicoCoupling.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 9 2024 16:10:28 for ls1-MarDyn by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
